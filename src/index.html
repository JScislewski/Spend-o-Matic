<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spend-o-Matic</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="css/styles.css">
        <style>
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
            body {
                display: flex;
                flex-direction: column;
                height: 100vh;
            }
            main.container {
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                min-height: 0;
                margin-top: 1.5rem;
                padding-top: 0.5rem !important;
                padding-bottom: 0.5rem !important;
            }
            main.container.split-mode {
                margin-top: 0.25rem !important;
                padding-top: 0.25rem !important;
            }
            .nav-tabs {
                display: flex !important;
                flex-direction: row !important;
            }
            .custom-navbar {
                min-height: 40px;
                padding-top: 2px;
                padding-bottom: 2px;
            }
            .site-footer {
                min-height: 30px;
                padding: 2px 0;
                font-size: 0.9rem;
            }
            .data-grid {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(3, auto);
                gap: 4px;
                margin-bottom: 0.5rem;
            }
            .data-grid-split {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
                margin-bottom: 0.5rem;
            }
            .data-grid-split .row {
                width: 100%;
            }
            .split-input {
                font-size: 1rem;
                height: 2.2rem;
                padding: 4px 8px;
            }
            .split-input {
                font-size: 0.75rem;
                height: 1.2rem;
                padding: 1px 3px;
            }
            #split-view {
                flex: 1;
                display: flex;
                flex-direction: column;
            }
            #split-view .row {
                flex: 1;
                margin: 0;
            }
            #split-view h2 {
                font-size: 1rem;
                margin-bottom: 0.5rem;
            }
            #incomeExpensesChart-split {
                max-width: 100%;
                max-height: 500px;
                width: 100%;
                height: 400px !important;
            }
            .split-view-content {
                height: 100%;
                display: flex;
                flex-direction: column;
            }
            .totals-row {
                margin-top: 0.5rem !important;
                clear: both;
            }
            .data-grid .col {
                padding: 2px !important;
                margin-bottom: 0 !important;
                min-width: 0;
            }
            .data-grid .fw-bold {
                font-size: 0.95rem;
                margin-bottom: 2px;
            }
            .form-control-sm {
                padding: 2px 6px;
                font-size: 0.9rem;
                height: 1.5rem;
            }
            .tab-pane {
                height: auto;
                overflow: visible;
            }
            #incomeExpensesChart {
                max-width: 1200px;
                max-height: 600px;
                width: 100%;
                height: 600px !important;
                margin: 0 auto;
                display: block;
            }
            h2 {
                font-size: 1.1rem;
                margin-bottom: 0.5rem;
            }
            /* Split active mode overrides */
            body.split-active #mainTabs,
            body.split-active #mainTabsContent { display: none !important; }
            body.split-active main.container { margin-top: 0.15rem !important; padding-top: 0.15rem !important; }
            body.split-active #split-view { display: flex !important; flex: 1 1 auto; margin: 0; padding: 0; }
            body.split-active #split-view .row { flex: 1 1 auto; align-items: stretch; min-height: 0; }
            body.split-active #split-view .split-view-content { flex: 1 1 auto; display: flex; flex-direction: column; }
            body.split-active #split-view h2 { margin-top: 0; }
            body.split-active footer.site-footer { margin-top: 0.25rem; }
        </style>
    <!-- Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header removed, brand moved to navbar -->
    <nav class="navbar navbar-expand-lg custom-navbar">
        <div class="container-fluid">
            <a class="navbar-brand text-white d-flex align-items-center gap-2" href="#">
                <span>Spend-o-Matic</span>
                <i class="bi bi-currency-dollar"></i>
                <i class="bi bi-bar-chart"></i>
            </a>
            <button id="view-toggle" class="btn btn-outline-light btn-sm" onclick="toggleViewMode()">
                <i class="bi bi-layout-split"></i> Split View
            </button>
        </div>
    </nav>
    <main class="container" id="main-container">
        <!-- Bootstrap Tabs -->
        <ul class="nav nav-tabs" id="mainTabs">
            <li class="nav-item">
                <button class="nav-link active" id="data-tab" data-bs-toggle="tab" data-bs-target="#data" type="button" role="tab" aria-controls="data" aria-selected="true">
                    Data
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="chart-tab" data-bs-toggle="tab" data-bs-target="#chart" type="button" role="tab" aria-controls="chart" aria-selected="false">
                    Chart
                </button>
            </li>
        </ul>
        <div class="tab-content pt-3" id="mainTabsContent">
            <div class="tab-pane fade show active" id="data" role="tabpanel" aria-labelledby="data-tab">
                <h2>Data</h2>
                <div class="data-grid">
                    <!-- Month cards: 4 columns, 3 rows -->
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">January</div><form class="w-100"><div class="mb-1"><label for="income-january" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-january" name="income-january" min="0" step="0.01" aria-label="Income for January" placeholder="Amount"></div><div class="mb-1"><label for="expenses-january" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-january" name="expenses-january" min="0" step="0.01" aria-label="Expenses for January" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">February</div><form class="w-100"><div class="mb-1"><label for="income-february" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-february" name="income-february" min="0" step="0.01" aria-label="Income for February" placeholder="Amount"></div><div class="mb-1"><label for="expenses-february" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-february" name="expenses-february" min="0" step="0.01" aria-label="Expenses for February" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">March</div><form class="w-100"><div class="mb-1"><label for="income-march" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-march" name="income-march" min="0" step="0.01" aria-label="Income for March" placeholder="Amount"></div><div class="mb-1"><label for="expenses-march" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-march" name="expenses-march" min="0" step="0.01" aria-label="Expenses for March" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">April</div><form class="w-100"><div class="mb-1"><label for="income-april" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-april" name="income-april" min="0" step="0.01" aria-label="Income for April" placeholder="Amount"></div><div class="mb-1"><label for="expenses-april" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-april" name="expenses-april" min="0" step="0.01" aria-label="Expenses for April" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">May</div><form class="w-100"><div class="mb-1"><label for="income-may" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-may" name="income-may" min="0" step="0.01" aria-label="Income for May" placeholder="Amount"></div><div class="mb-1"><label for="expenses-may" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-may" name="expenses-may" min="0" step="0.01" aria-label="Expenses for May" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">June</div><form class="w-100"><div class="mb-1"><label for="income-june" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-june" name="income-june" min="0" step="0.01" aria-label="Income for June" placeholder="Amount"></div><div class="mb-1"><label for="expenses-june" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-june" name="expenses-june" min="0" step="0.01" aria-label="Expenses for June" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">July</div><form class="w-100"><div class="mb-1"><label for="income-july" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-july" name="income-july" min="0" step="0.01" aria-label="Income for July" placeholder="Amount"></div><div class="mb-1"><label for="expenses-july" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-july" name="expenses-july" min="0" step="0.01" aria-label="Expenses for July" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">August</div><form class="w-100"><div class="mb-1"><label for="income-august" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-august" name="income-august" min="0" step="0.01" aria-label="Income for August" placeholder="Amount"></div><div class="mb-1"><label for="expenses-august" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-august" name="expenses-august" min="0" step="0.01" aria-label="Expenses for August" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">September</div><form class="w-100"><div class="mb-1"><label for="income-september" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-september" name="income-september" min="0" step="0.01" aria-label="Income for September" placeholder="Amount"></div><div class="mb-1"><label for="expenses-september" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-september" name="expenses-september" min="0" step="0.01" aria-label="Expenses for September" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">October</div><form class="w-100"><div class="mb-1"><label for="income-october" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-october" name="income-october" min="0" step="0.01" aria-label="Income for October" placeholder="Amount"></div><div class="mb-1"><label for="expenses-october" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-october" name="expenses-october" min="0" step="0.01" aria-label="Expenses for October" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">November</div><form class="w-100"><div class="mb-1"><label for="income-november" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-november" name="income-november" min="0" step="0.01" aria-label="Income for November" placeholder="Amount"></div><div class="mb-1"><label for="expenses-november" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-november" name="expenses-november" min="0" step="0.01" aria-label="Expenses for November" placeholder="Amount"></div></form></div></div>
                    <div class="col"><div class="p-2 border bg-light d-flex flex-column align-items-center"><div class="fw-bold mb-1">December</div><form class="w-100"><div class="mb-1"><label for="income-december" class="form-label">Income:</label><input type="number" class="form-control form-control-sm" id="income-december" name="income-december" min="0" step="0.01" aria-label="Income for December" placeholder="Amount"></div><div class="mb-1"><label for="expenses-december" class="form-label">Expenses:</label><input type="number" class="form-control form-control-sm" id="expenses-december" name="expenses-december" min="0" step="0.01" aria-label="Expenses for December" placeholder="Amount"></div></form></div></div>
                </div>
                <div class="totals-row d-flex justify-content-between gap-2">
                    <div class="flex-fill p-3 border bg-light text-center fw-bold">
                        Total Income: <span id="total-income">0</span>
                    </div>
                    <div class="flex-fill p-3 border bg-light text-center fw-bold">
                        Total Expenses: <span id="total-expenses">0</span>
                    </div>
                </div>
                </div>
            </div>
            <div class="tab-pane fade" id="chart" role="tabpanel" aria-labelledby="chart-tab">
                <h2>Chart</h2>
                <canvas id="incomeExpensesChart" width="1200" height="600"></canvas>
            </div>
        </div>
        
        <!-- Split View Layout (initially hidden) -->
        <div id="split-view" class="d-none">
            <div class="row">
                <div class="col-6 pe-2">
                    <div class="split-view-content">
                        <h2>Data</h2>
                        <div class="data-grid-split">
                            <!-- Month cards: 1 column, 12 rows for split view -->
                            <div class="row g-2 flex-column">
                                <div class="col mb-2" style="width:100%" id="split-month-january">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">January</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-january-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-january-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-february">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">February</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-february-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-february-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-march">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">March</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-march-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-march-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-april">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">April</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-april-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-april-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-may">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">May</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-may-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-may-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-june">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">June</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-june-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-june-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-july">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">July</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-july-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-july-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-august">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">August</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-august-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-august-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-september">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">September</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-september-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-september-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-october">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">October</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-october-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-october-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-november">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">November</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-november-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-november-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                                <div class="col mb-2" style="width:100%" id="split-month-december">
                                    <div class="p-2 border bg-light d-flex align-items-center justify-content-between">
                                        <div class="fw-bold" style="font-size: 1rem; min-width: 90px;">December</div>
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="income-december-split" min="0" step="0.01" placeholder="Income">
                                        <input type="number" class="form-control form-control-sm split-input flex-grow-1 mx-2" id="expenses-december-split" min="0" step="0.01" placeholder="Expenses">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="totals-row d-flex justify-content-between gap-2 mt-2">
                            <div class="flex-fill p-2 border bg-light text-center fw-bold">
                                Total Income: <span id="total-income-split">0</span>
                            </div>
                            <div class="flex-fill p-2 border bg-light text-center fw-bold">
                                Total Expenses: <span id="total-expenses-split">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6 ps-2">
                    <div class="split-view-content">
                        <h2>Chart</h2>
                        <div style="height: 400px; width: 100%; position: relative;">
                            <canvas id="incomeExpensesChart-split" style="width: 100%; height: 400px;"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="text-white text-center site-footer">
    <p>&copy; 2025 Spend-o-Matic. All rights reserved.</p>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        let isSplitView = false;
        let splitChart = null;

        function setSplitChartHeight() {
            const dataCol = document.querySelector('#split-view .col-6.pe-2');
            const chartCol = document.querySelector('#split-view .col-6.ps-2');
            const chartContainer = document.getElementById('split-chart-container');
            const chartCanvas = document.getElementById('incomeExpensesChart-split');
            if (dataCol && chartCol && chartContainer && chartCanvas) {
                const dataHeight = dataCol.offsetHeight;
                chartCol.style.height = dataHeight + 'px';
                chartContainer.style.height = dataHeight + 'px';
                chartCanvas.style.height = dataHeight + 'px';
            }
        }

        window.addEventListener('resize', function() {
            if (document.body.classList.contains('split-active')) {
                setSplitChartHeight();
            }
        });

        function toggleViewMode() {
            const splitView = document.getElementById('split-view');
            const toggleBtn = document.getElementById('view-toggle');
            const mainContainer = document.getElementById('main-container');
            const bodyEl = document.body;
            const chartPane = document.getElementById('chart');
            const enterSplit = () => {
                setTimeout(setSplitChartHeight, 150);
                bodyEl.classList.add('split-active');
                splitView.classList.remove('d-none');
                mainContainer.classList.add('split-mode');
                if (chartPane) chartPane.style.display = 'none';
                // Safely destroy main chart if it exists and has destroy method
                if (window.chart && typeof window.chart.destroy === 'function') {
                    window.chart.destroy();
                    window.chart = null;
                }
                toggleBtn.innerHTML = '<i class="bi bi-layout-three-columns"></i> Tab View';
                syncDataToSplit();
                // Delay chart init to ensure DOM is visible
                setTimeout(() => {
                    initSplitChart();
                }, 100);
            };
            const exitSplit = () => {
                bodyEl.classList.remove('split-active');
                splitView.classList.add('d-none');
                mainContainer.classList.remove('split-mode');
                if (chartPane) chartPane.style.display = 'block';
                toggleBtn.innerHTML = '<i class="bi bi-layout-split"></i> Split View';
                syncDataFromSplit();
                // Always update chart after syncing data back
                if (typeof updateChart === 'function') setTimeout(updateChart, 50);
                if (splitChart) { splitChart.destroy(); splitChart = null; }
            };
            isSplitView ? exitSplit() : enterSplit();
            isSplitView = !isSplitView;
        }

        function syncDataToSplit() {
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            
            months.forEach(month => {
                const incomeValue = document.getElementById(`income-${month}`).value;
                const expensesValue = document.getElementById(`expenses-${month}`).value;
                
                document.getElementById(`income-${month}-split`).value = incomeValue;
                document.getElementById(`expenses-${month}-split`).value = expensesValue;
            });
            
            updateSplitTotals();
            setTimeout(setSplitChartHeight, 50);
        }

        function syncDataFromSplit() {
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            
            months.forEach(month => {
                const incomeValue = document.getElementById(`income-${month}-split`).value;
                const expensesValue = document.getElementById(`expenses-${month}-split`).value;
                
                document.getElementById(`income-${month}`).value = incomeValue;
                document.getElementById(`expenses-${month}`).value = expensesValue;
            });
            
            updateTotals();
            updateChart();
        }

        function initSplitChart() {
            const ctx = document.getElementById('incomeExpensesChart-split');
            
            if (!ctx) {
                console.error('Split chart canvas not found');
                return;
            }
            
            // Check if canvas has dimensions
            const rect = ctx.getBoundingClientRect();
            console.log('Canvas dimensions:', rect.width, 'x', rect.height);
            
            if (rect.width === 0 || rect.height === 0) {
                console.warn('Canvas has no dimensions, retrying...');
                setTimeout(() => initSplitChart(), 50);
                return;
            }
            
            if (splitChart) {
                splitChart.destroy();
                splitChart = null;
            }
            
            const incomeData = [];
            const expensesData = [];
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            
            months.forEach(month => {
                const income = parseFloat(document.getElementById(`income-${month}-split`).value) || 0;
                const expenses = parseFloat(document.getElementById(`expenses-${month}-split`).value) || 0;
                incomeData.push(income);
                expensesData.push(expenses);
            });
            
            try {
                splitChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 
                                'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                        datasets: [
                            {
                                label: 'Income',
                                data: incomeData,
                                backgroundColor: 'rgb(40, 167, 69)',
                                borderColor: 'rgba(40, 167, 69, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Expenses',
                                data: expensesData,
                                backgroundColor: 'rgb(220, 53, 69)',
                                borderColor: 'rgba(220, 53, 69, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                console.log('Split chart initialized successfully');
            } catch (error) {
                console.error('Error initializing split chart:', error);
            }
        }

        function updateSplitTotals() {
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            
            let totalIncome = 0;
            let totalExpenses = 0;
            
            months.forEach(month => {
                const income = parseFloat(document.getElementById(`income-${month}-split`).value) || 0;
                const expenses = parseFloat(document.getElementById(`expenses-${month}-split`).value) || 0;
                totalIncome += income;
                totalExpenses += expenses;
            });
            
        document.getElementById('total-income-split').textContent = totalIncome.toFixed(2);
        document.getElementById('total-expenses-split').textContent = totalExpenses.toFixed(2);
    }

        // Add event listeners to split view inputs
        document.addEventListener('DOMContentLoaded', function() {
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            
            months.forEach(month => {
                const incomeInput = document.getElementById(`income-${month}-split`);
                const expensesInput = document.getElementById(`expenses-${month}-split`);
                
                incomeInput.addEventListener('input', updateSplitTotals);
                expensesInput.addEventListener('input', updateSplitTotals);
            });
        });
    </script>
</body>
</html>